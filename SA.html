<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shopping Website</title>
  <link href="product.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <style>
    body {
      background-image: url('images/background.png');
      background-size: cover;
      background-repeat: no-repeat;
      font-family: Hoyo;
    }

    .btn {
      display: inline-block;
      font-size: 18px;
      text-align: center;
      text-decoration: none;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    .btn-primary {
      color: #fff !important;
      background-color: #7a8a8d !important;
    }

    .btn-primary:hover {
      background-color: #303536 !important;
    }

    .btn-primary:active {
      background-color: #303536 !important;
      color: #fff !important;
    }

    .remove {
      margin-left: -5px;
      margin-top: 5px;
      padding: 5px 10px;
      font-size: 12px;
      color: rgb(192, 0, 0);
      background-color: transparent;
    }

    .remove:hover {
      margin-left: -5px;
      margin-top: 5px;
      padding: 5px 10px;
      font-size: 12px;
      color: rgb(105, 0, 0);
      background-color: transparent;
      text-decoration: underline;
    }
  </style>
</head>

<body>

  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container">
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
        aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse ms-auto" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="index.html">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="about.html">About</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">Products</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="contact.html">Contact</a>
          </li>
        </ul>
      </div>
      <form class="d-flex">
        <input class="form-control me-2" style="width: 600px; border-radius: 20px;" type="search"
          placeholder="🔍 Search for products..." aria-label="Search">
      </form>
    </div>
  </nav>

  <div class="container-fluid">
    <div class="row">
      <div class="col-md-3">
        <div class="container bg-white p-3 rounded ShoppingCart" style="margin-left: -20px;">
          <h2 class="shop">Shopping Cart</h2>
          <ul id="cart" class="list-group crt"></ul>
          <hr class="hsr">
          <h4 class="h">Total: <span id="total"></span></h4>
          <hr class="hsr">
          <div class="md-3">
            <h4 class="Delivery-details">Delivery Details</h4>
            <form id="deliveryForm">
              <div class="mb-3">
                <label for="name" class="form-label">Name:</label>
                <input type="text" id="name" class="form-control" required>
              </div>
              <div class="mb-3">
                <label for="address" class="form-label">Address:</label>
                <textarea id="address" class="form-control" required></textarea>
              </div>
              <div class="mb-3">
                <label for="email" class="form-label">Email:</label>
                <input type="email" id="email" class="form-control" required>
              </div>
            </form>
          </div>
          <button id="checkoutBtn" class="btn btn-primary">Checkout</button>
        </div>
      </div>

      <div class="col-md-9">
        <form id="categoryForm">
          <div class="mb-3">
            <label for="category" class="form-label shoppingtext">Select Category:</label>
            <select id="category" class="form-select">
              <option value="figurines">Figurines & Plushies</option>
              <option value="keychain">Keychain</option>
              <option value="phonecase">Phonecase</option>
              <option value="clothing">Clothing</option>
              <option value="cups">Tumbler & Mugs</option>
            </select>
          </div>
        </form>
        <div id="productDisplay" class="row">
        </div>
      </div>
    </div>
  </div>

  <footer class="footer">
    <div class="container text-center">
      <img src="images/HOYO.png" alt="footer">
    </div>
  </footer>


  <script>
    const products = {
      figurines: [
        { name: "Seele Figurine", price: 20, image: "images/Seele.png" },
        { name: "Stelle Figurine", price: 20, image: "images/Stelle.png" },
        { name: "Bronya Figurine", price: 20, image: "images/Bronya.png" },
        { name: "DanHeng IL Plushie", price: 15, image: "images/DanHeng.jpg" },
        { name: "Luocha Plushie", price: 10, image: "images/Luocha.jpg" },
        { name: "Blade Plushie", price: 15, image: "images/Blade.jpg" },
      ],
      keychain: [
        { name: "Keychain Combo 1", price: 30, image: "images/KEYCHAIN.jpg" },
        { name: "Keychain Combo 2", price: 30, image: "images/Keychains.jpg" },
        { name: "Keychain Combo 3", price: 30, image: "images/Preppy.jpg" },
        { name: "Keychain Combo 4", price: 30, image: "images/keychian.jpg" },
        { name: "Keychain Combo 5", price: 30, image: "images/Sparkle.jpg" },
        { name: "Keychain Combo 6", price: 30, image: "images/SW.jpg" },
      ],
      phonecase: [
        { name: "Bailu Phone Case", price: 60, image: "images/phone.jpg" },
        { name: "Choose 1 design.", price: 70, image: "images/Phonecase.jpg" },
        { name: "Kafka Phone Case", price: 60, image: "images/phone2.jpg" },
        { name: "Blade or Luocha Case", price: 60, image: "images/phone3.jpg" },
        { name: "Choose 1 of the designs.", price: 70, image: "images/phonecase2.jpg" },
        { name: "DanHeng or Fu Xuan Case", price: 60, image: "images/phone4.jpg" },
      ],
      clothing: [
        { name: "Jingliu Cosplay.", price: 120, image: "images/JL.png" },
        { name: "Ruan Mei Cosplay", price: 130, image: "images/rm.jpg" },
        { name: "Himeko Cosplay", price: 150, image: "images/himeko.jpg" },
        { name: "DanHeng IL Cosplay", price: 150, image: "images/dhil.png" },
        { name: "Dr. Ratio Cosplay", price: 130, image: "images/ratio.jpg" },
        { name: "Welt Cosplay", price: 120, image: "images/welt.jpg" },
      ],
      cups: [
        { name: "Kafka Tumbler", price: 20, image: "images/kafk.jpg" },
        { name: "Stelle Mug", price: 10, image: "images/stelle.jpg" },
        { name: "March 7th Tumbler", price: 20, image: "images/march.jpg" },
        { name: "SilverWolf Tumbler", price: 20, image: "images/silverwolf.jpg" },
        { name: "Caelus Mug", price: 10, image: "images/caelus.jpg" },
        { name: "Herta Tumbler", price: 20, image: "images/hert.jpg" },
      ]
    };

    function displayProducts(category) {
      const productsToShow = products[category];
      const productDisplay = document.getElementById("productDisplay");
      productDisplay.innerHTML = "";
      for (let i = 0; i < productsToShow.length; i++) {
        const product = productsToShow[i];
        const card = document.createElement("div");
        card.className = "col-md-4 mb-3";
        const innerCard = document.createElement("div");
        innerCard.className = "card product-card";
        const image = document.createElement("img");
        image.src = product.image;
        image.className = "card-img-top";
        image.alt = product.name;
        const cardBody = document.createElement("div");
        cardBody.className = "card-body";
        const title = document.createElement("h5");
        title.className = "card-title";
        title.textContent = product.name;
        const price = document.createElement("p");
        price.className = "card-text";
        price.textContent = "$" + product.price;
        const button = document.createElement("button");
        button.className = "btn btn-primary add-to-cart";
        button.dataset.name = product.name;
        button.dataset.price = product.price;
        button.textContent = "Add to Cart";
        cardBody.appendChild(title);
        cardBody.appendChild(price);
        cardBody.appendChild(button);
        innerCard.appendChild(image);
        innerCard.appendChild(cardBody);
        card.appendChild(innerCard);
        productDisplay.appendChild(card);
      }
    }

    document.getElementById("categoryForm").addEventListener("change", function (event) {
      const category = event.target.value;
      displayProducts(category);
    });

    document.getElementById("productDisplay").addEventListener("click", function (event) {
      if (event.target.classList.contains("add-to-cart")) {
        const name = event.target.dataset.name;
        const price = parseFloat(event.target.dataset.price);
        addToCart(name, price);
      }
    });

    function addToCart(name, price) {
      const cart = document.getElementById("cart");
      const listItem = document.createElement("li");
      listItem.className = "list-group-item";
      listItem.innerHTML = `${name} - $${price} <button class="btn btn-danger remove">Remove</button>`;
      listItem.dataset.price = price;
      cart.appendChild(listItem);
      updateTotal(price);
    }

    function removeFromCart(item) {
      const price = parseFloat(item.dataset.price);
      item.remove();
      updateTotal(-price);
    }

    document.getElementById("cart").addEventListener("click", function (event) {
      if (event.target.classList.contains("remove")) {
        const listItem = event.target.parentNode;
        removeFromCart(listItem);
      }
    });

    function updateTotal(price) {
      const totalElement = document.getElementById("total");
      let total = parseFloat(totalElement.innerText);
      if (isNaN(total)) {
        total = 0;
      }
      total += price;
      totalElement.innerText = total.toFixed(2);
    }

    document.getElementById("checkoutBtn").addEventListener("click", function () {

      const name = document.getElementById("name").value.trim();
      const address = document.getElementById("address").value.trim();
      const email = document.getElementById("email").value.trim();

      if (name === '' || address === '' || email === '') {
        alert("Please fill out all delivery details.");
        return;
      }

      const cartItems = Array.from(document.querySelectorAll("#cart li"));
      if (cartItems.length === 0) {
        alert("Your cart is empty. Please add some items before checkout.");
        return;
      }

      const order = cartItems.map(item => {
        const [itemName, itemPrice] = item.innerText.split(" - $");
        return { prod_name: itemName.trim(), prod_price: parseFloat(itemPrice) };
      });

      const data = {
        cust_name: name,
        cust_addr: address,
        cust_email: email,
        cust_order: JSON.stringify(order)
      };
      const queryString = new URLSearchParams(data).toString();
      window.location.href = `http://sirjm.infinityfreeapp.com/checkout.php?${queryString}`;
    });

    displayProducts("figurines");

    window.onload = function () {

      var pageTitle = document.title;
      var attentionMessage = 'Dont leave us hanging. Buy NOW!';

      document.addEventListener('visibilitychange', function (e) {
        var isPageActive = !document.hidden;

        if (!isPageActive) {
          document.title = attentionMessage;
        } else {
          document.title = pageTitle;
        }
      });
    };

  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
    integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
    integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
    crossorigin="anonymous"></script>

</body>

</html>